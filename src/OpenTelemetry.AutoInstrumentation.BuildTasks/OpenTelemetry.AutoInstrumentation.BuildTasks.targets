<Project>

  <UsingTask
    TaskName="CheckForInstrumentationPackages"
    AssemblyFile="$(MSBuildThisFileDirectory)netstandard2.0\OpenTelemetry.AutoInstrumentation.BuildTasks.dll" />

  <Target Condition="'$(DisableCheckForInstrumentationPackagesTarget)' != 'true'"
    Name="CheckForInstrumentationPackagesTarget"
    AfterTargets="ResolvePackageAssets">

    <ItemGroup Label="InstrumentationTargetItems">

      <InstrumentationTarget
        Include="MongoDB.Driver.Core"
        Condition="!$(DisabledInstrumentations.Contains('MongoDB.Driver.Core'))"
        TargetNuGetPackageVersionRange="[2.13.3, 3.0.0)"
        InstrumentationNuGetPackageId="MongoDB.Driver.Core.Extensions.DiagnosticSources"
        InstrumentationNuGetPackageVersion="1.3.0" />

      <InstrumentationTarget
        Include="StackExchange.Redis"
        Condition="!$(DisabledInstrumentations.Contains('StackExchange.Redis'))"
        TargetNuGetPackageVersionRange="[2.1.58, 3.0.0)"
        InstrumentationNuGetPackageId="OpenTelemetry.Instrumentation.StackExchangeRedis"
        InstrumentationNuGetPackageVersion="1.0.0-rc9.8" />

    </ItemGroup>

    <CheckForInstrumentationPackages
      InstrumentationTargetItems="@(InstrumentationTarget)"
      RuntimeCopyLocalItems="@(RuntimeCopyLocalItems)"
      UseVerboseLog="$(UseVerboseLog)" />

  </Target>

</Project>
